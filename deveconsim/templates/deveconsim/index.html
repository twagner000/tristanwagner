{% extends "tristanwagner/base.html" %}
{% load staticfiles %}
{% load humanize %}
{% load deveconsim_extras %}

{% block content %}
    {% if turn %}
        <div>            
            <nav class="navbar navbar-inverse">
                <div class="container-fluid">
                    <!-- Brand and toggle get grouped for better mobile display -->
                    <div class="navbar-header">
                      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#game-navbar-collapse" aria-expanded="false">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                      </button>
                      <a class="navbar-brand" href="#"><span class="glyphicon glyphicon-globe" aria-hidden="true"></span> Globalization Game</a>
                    </div>

                    <!-- Collect the nav links, forms, and other content for toggling -->
                    <div class="collapse navbar-collapse" id="game-navbar-collapse">
                        <ul class="nav navbar-nav">
                            <li class="active"><a href="#tutorial" aria-controls="tutorial" role="tab" data-toggle="tab"><span class="glyphicon glyphicon-info-sign" aria-hidden="true"></span> Tutorial</a></li>
                            <li><a href="#budget" aria-controls="budget" role="tab" data-toggle="tab"><span class="glyphicon glyphicon-stats" aria-hidden="true"></span> Budget</a></li>
                            <li><a href="#crops" aria-controls="crops" role="tab" data-toggle="tab"><span class="glyphicon glyphicon-grain" aria-hidden="true"></span> Crops</a></li>
                            <li><a href="#debt" aria-controls="debt" role="tab" data-toggle="tab"><span class="glyphicon glyphicon-piggy-bank" aria-hidden="true"></span> Debt</a></li>
                            <li><a href="#people" aria-controls="people" role="tab" data-toggle="tab"><span class="glyphicon glyphicon-user" aria-hidden="true"></span> People</a></li>
                        </ul>
                        <form class="navbar-form navbar-right">
                            <button type="submit" class="btn btn-default">End Turn</button>
                        </form>
                        <ul class="nav navbar-nav navbar-right">
                            <li><a><span class="glyphicon glyphicon-repeat" aria-hidden="true"></span> {{turn.turn}}</a></li>
                        </ul>
                    </div>
                </div>
            </nav>
            
            <!--div class="navbar navbar-fixed-top">
                <div class="navbar-header pull-left">
                  <a class="navbar-brand" href="#">Title Here</a>
                </div>
                <div class="navbar-header pull-right">
                  <button type="button" class="btn btn-default navbar-btn">Button 1</button>
                  <button type="button" class="btn btn-default navbar-btn">Button 2</button>
                </div>
            </div-->
            
            
            <div class="tab-content">
                <div role="tabpanel" class="tab-pane active" id="tutorial">
                   
                </div>
                
                <div role="tabpanel" class="tab-pane" id="budget">

                </div>
                
                <div role="tabpanel" class="tab-pane" id="crops"><h4>Crops</h4></div>
                <div role="tabpanel" class="tab-pane" id="debt"><h4>Debt</h4></div>
                <div role="tabpanel" class="tab-pane" id="people"><h4>People</h4></div>
            </div>
        </div>
        
        <div>
        {% if turn.turn == 1 %}
            <div class="alert alert-info" role="alert">
                <h4>Tutorial: Part I</h4>
                <p>Welcome to the Developing Countries Simulation Game!</p>
                <p>This game is meant to give you insight into the difficulties of integrating a developing country into the world economy by putting you in charge.</p>
                <p>Your country does not start out with much industry, so you rely on agriculture for most of your income.
                Click <b><span class="glyphicon glyphicon-grain" aria-hidden="true"></span> Crops</b> from the game menu to learn more.</p>
                <p><button type="button" class="btn btn-primary" data-toggle="modal" data-target="#myModal">Continue</button></p>
            </div>

            <div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
                <div class="modal-dialog modal-lg" role="document">
                    <div class="modal-content">
                        <div class="modal-header">
                            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                            <h4 class="modal-title" id="myModalLabel">Tutorial: Part I (Continued)</h4>
                        </div>
                        <div class="modal-body">
                            <p>This page allows you to control portions of how crops are grown in your country. You may choose between two crops: corn and cocoa.</p>
                            <p>Corn represents the many types of basic food crops that are grown in developing countries. Often these crops are grown by small farmers simply for food (rather than to sell). This is called subsistence farming. These crops usually fetch fairly low prices when they are sold as exports.</p>
                            <p>Cocoa represents cash crops-- crops grown by many countries for the sole purpose of generating income. These crops usually cannot be eaten or are too expensive for the local people to eat in any substantial quantity. However, they often bring badly needed money into the country though their export. Other cash crops include coffee, sugar, tobacco, and many others.</p>
                            <p>You can find current prices for both corn and cocoa in the table with general information on crops in your country. If you click on the link that is one of the crop prices, you will be taken to a page with a graph of that crop's prices so far.</p>
                            <p>You can change which crops you have planted in your country by clicking on the link at the bottom of this text where it says &quot;Actions&quot;, or by clicking on one of the links that is either how much corn or cocoa you have planted already. At the bottom of the page that lets you change how your crops are planted you will find a table with more information.</p>
                            <p>It costs money to change what types of crops you have planted. This price is different for the two crops. The World Bank will give you a loan to cover the cost of planting cocoa (not corn), however, because the World Bank believes increased export of cash crops will help your country's economy.</p>
                            <p>You may also choose which type of pesticides that farms in your country will use. Pesticides are paid for by the owners of the farms, not the government. Your first option is to use no pesticides, which will result in relatively low crop yields (the amount produced) but will not harm the environment. You can also choose to use either cheap or expensive pesticides. The cheap pesticides in this game have been declared illegal in the U.S.A. due to their negative effects on the environment. They will result in substantial increases in crop yields, but yields will gradually decrease over time due to the environmental damage. The expensive pesticides in this game are more costly than the cheap pesticides, but they do not cause as much environmental damage. They increase yields even slightly more than the cheap pesticides, and yields decrease by a smaller amount than with the cheap pesticides. You can find a detailed table with the effects of all pesticides at the bottom of the page that allows you to change pesticide use (which you can get to from the link at the bottom of this text where it says &quot;Actions&quot;, or by clicking on the link that is your current pesticide use in the table with general crop information).</p>
                            <p>When you are done reading this information and have made any changes that you wish to make, please return to the main page of the simulation game and click the &quot;End Year&quot; button to continue with the tutorial. You may find that you do not have enough income to cover expenses for your country; if that is the case, you will probably have to return to this page and make more changes. You can check how much income your government is generating on the main page of the simulation game, in the &quot;Budget&quot; table. If you wish, you may end with a negative balance, so long as it doesn't exceed the size of your General Fund. You may only have a negative balance larger than your General Fund if the difference is less than the size of your World Bank interest payment for the year, in which case the World Bank will make you a special offer.</p>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                        </div>
                    </div><!-- /.modal-content -->
                </div><!-- /.modal-dialog -->
            </div><!-- /.modal -->
        {% elif turn.turn == 2 %}
            <div class="alert alert-info" role="alert">
                <h4>Tutorial: Part II</h4>
                <p>Well, you've made it through your first year as leader of a developing country successfully!
                Congratulations! There is some bad news to report, though-- cocoa prices have fallen.
                You can see a graph by clicking on the link that is the current cocoa price in the crops table.
                You may wish to change how your crops are planted based on this new information, but remember, it costs money to plant crops.
                In addition, if you used pesticides, the productivity of your country's land will have decreased slightly, resulting in slightly smaller crop yields.</p>
                <p>To continue on with the tutorial, this year we will look at your country's budget.
                Within the budget, you can raise taxes and spend money on services for your citizens.
                You can get to the budget section by either clicking on the link at the top of the &quot;Budget&quot; table below, or you can use the &quot;Budget&quot; link in the &quot;Simulation Game&quot; menu to the left.
                The tutorial will continue there, and you can return here to the main page as soon as you are finished with that portion.</p>
            </div>
        {% elif turn.turn == 3 %}
            <div class="alert alert-info" role="alert">
                <h4>Tutorial: Part III</h4>
                <p>I'm afraid I have some more bad news for you. Cocoa prices have fallen again, although not as much as they fell last year.
                The reason for this is that other developing countries like yours have decided to plant cocoa also, increasing the world supply of cocoa and driving prices down.</p>
                <p>On the other hand, you have made it to your third year-- many leaders of your country haven't lasted even that long.
                This year you will find out how to repay your country's debts to private banks and the World Bank, to reduce the size of your country's annual interest payments.
                You can get to the debt section by either clicking on the link at the top of the &quot;Debt&quot; table below, or you can use the &quot;Debt&quot; link in the &quot;Simulation Game&quot; menu to the left.
                The tutorial will continue there, and you can return here to the main page as soon as you are finished with that portion.</p>
            </div>
        {% elif turn.turn == 4 %}
            <div class="alert alert-info" role="alert">
                <h4>Tutorial: Part IV</h4>
                <p>Cocoa prices dropped again this year, rather steeply.
                If you wish, you may look at the graph by clicking on the link that is the current price of cocoa.</p>
                <p>This year is the final year of the tutorial (you are encouraged to continue playing the game afterwards, now that you know how!).
                In this part of the tutorial, we will learn how you can check the happiness of your country's citizens, and what the results of very unhappy citizens can be.
                You can get to the happiness section by either clicking on the link at the top of the &quot;Happiness&quot; table below, or you can use the &quot;Happines&quot; link in the &quot;Simulation Game&quot; menu to the left.
                The tutorial will continue and finish there, and you will be free to continue however you wish.</p>
            </div>
        {% else %}
            <div class="alert alert-info" role="alert">
                <p>You have completed the tutorial. To change how your country is run, or to learn what something means, click on the link at the top of a section (e.g., &quot;Budget&quot;).
                Once you have finished making changes, press the &quot;End Year&quot; button to continue on to the next year.</p>
            </div>
        {% endif %}
            
            <h4><span class="glyphicon glyphicon-stats" aria-hidden="true"></span> Budget</h4>
            <div class="row">
                <div class="col-sm-12 col-md-4">
                    <div class="panel panel-default">
                        <table class="table">
                            <tr><th colspan="2">Summary</th></tr>
                            <tr><td>Total Income</td><td class="text-right">${{calc.inc_total|floatformat:0|intcomma}}</td></tr>
                            <tr><td>Total Expenses</td><td class="text-right">${{calc.exp_total|floatformat:0|intcomma}}</td></tr>
                            <tr><td>Net Income</td><td class="text-right">${{calc.net|floatformat:0|intcomma}}</td></tr>
                            <tr><td>Current General Fund</td><td class="text-right">${{turn.genfund|floatformat:0|intcomma}}</td></tr>
                            <tr class="active"><td>Forecasted General Fund</td><td class="text-right">${{calc.new_genfund|floatformat:0|intcomma}}</td></tr>
                        </table>
                    </div>
                </div>
                
                <div class="col-sm-12 col-md-4">
                    <div class="panel panel-default">
                        <table class="table">
                            <tr><th colspan="3">Income</th></tr>
                            <tr><td>Cocoa Export Tax</td><td class="text-right"><a href="#">{{turn.tax_cocoa|percent:"1,0"}}</a></td><td class="text-right">${{calc.inc_cocoa|floatformat:0|intcomma}}</td></tr>
                            <tr><td>Income Tax - Lower Bracket</td><td class="text-right"><a href="#">{{turn.tax_lower|percent:"1,0"}}</a></td><td class="text-right">${{calc.inc_lower|floatformat:0|intcomma}}</td></tr>
                            <tr><td>Income Tax - Upper Bracket</td><td class="text-right"><a href="#">{{turn.tax_upper|percent:"1,0"}}</a></td><td class="text-right">${{calc.inc_upper|floatformat:0|intcomma}}</td></tr>
                            <tr><td colspan="4">&nbsp;</td></tr>
                            <tr><td colspan="2">Total</td><td class="text-right">${{calc.inc_total|floatformat:0|intcomma}}</td></tr>
                        </table>
                    </div>
                </div>
                
                <div class="col-sm-12 col-md-4">
                    <div class="panel panel-default">
                        <table class="table">
                            <tr><th colspan="4">Expenses</th></tr>
                            <tr><td>Health Care</td><td class="text-right"><a href="#">{{turn.svc_health|percent:"1,0"}}</a></td><td colspan="2" class="text-right">${{calc.exp_health|floatformat:0|intcomma}}</td></tr>
                            <tr><td>Education</td><td class="text-right"><a href="#">{{turn.svc_education|percent:"1,0"}}</a></td><td colspan="2" class="text-right">${{calc.exp_education|floatformat:0|intcomma}}</td></tr>
                            <tr><td>Security</td><td class="text-right"><a href="#">{{turn.svc_security|percent:"1,0"}}</a></td><td colspan="2" class="text-right">${{calc.exp_security|floatformat:0|intcomma}}</td></tr>
                            <tr><td colspan="2">Debt Interest</td><td colspan="2" class="text-right">${{calc.exp_debt_int|floatformat:0|intcomma}}</td></tr>
                            <tr><td colspan="2">Total</td><td colspan="2" class="text-right">${{calc.exp_total|floatformat:0|intcomma}}</td></tr>
                        </table>
                    </div>
                </div>
            </div>
                
            
            <div class="row">
                <div class="col-sm-12 col-md-8">
                    <h4><span class="glyphicon glyphicon-grain" aria-hidden="true"></span> Crops</h4>
                    <div class="panel panel-default">
                        <table class="table">
                            <tr><td colspan="3">Plantable Area</td><td class="text-right">{{turn.land|intcomma}} Ha</td></tr>
                            <tr><td colspan="3">Land Productivity</td><td class="text-right">{{turn.landprod|percent}}</td></tr>
                            <tr><td colspan="3">Pesticide Use</td><td class="text-right"><a href="#">{{turn.get_pesticides_display}}</a></td></tr>
                            <tr><th>Crop</th><th class="text-right">Area Planted</th><th class="text-right">Expected Yield</th><th class="text-right">Current Price</th></tr>
                            <tr><td>Corn</td><td class="text-right"><a href="#">{{turn.corn|intcomma}} Ha</a></td><td class="text-right">{{calc.corn.yield|floatformat:0|intcomma}} kg/ha</td><td class="text-right"><a href="#">${{calc.corn.price|floatformat:3|intcomma}}/kg</a></td></tr>
                            <tr><td>Cocoa</td><td class="text-right"><a href="#">{{turn.cocoa|intcomma}} Ha</a></td><td class="text-right">{{calc.cocoa.yield|floatformat:0|intcomma}} kg/ha</td><td class="text-right"><a href="#">${{calc.cocoa.price|floatformat:3|intcomma}}/kg</a></td></tr>
                            <tr><td>Not Planted</td><td class="text-right">{{calc.unplanted|intcomma}} Ha</td><td class="text-right"></td><td class="text-right"></td></tr>
                        </table>
                    </div>
                    
                    <h4><span class="glyphicon glyphicon-piggy-bank" aria-hidden="true"></span> Debt</h4>
                    <div class="panel panel-default">
                        <table class="table">
                            <tr><th>Creditor</th><th class="text-right">Balance Owed</th><th class="text-right">Interest Rate</th><th class="text-right">Annual Interest</th></tr>
                            <tr><td>Private Banks</td><td class="text-right"><a href="#">${{turn.debt_private|floatformat:0|intcomma}}</a></td><td class="text-right">{{turn.game.INT_RATE.private|percent:"1,2"}}</td><td class="text-right">${{calc.debt_private_int|floatformat:0|intcomma}}</td></tr>
                            <tr><td>World Bank</td><td class="text-right"><a href="#">${{turn.debt_wb|floatformat:0|intcomma}}</a></td><td class="text-right">{{turn.game.INT_RATE.wb|percent:"1,2"}}</td><td class="text-right">${{calc.debt_wb_int|floatformat:0|intcomma}}</td></tr>
                            <tr><td>World Bank with <abbr data-toggle="popover" data-placement="bottom" title="Structural Adjustment Program" data-content="Limits Health spending to 15% and Security spending to 20% until loan is repaid. Requires planting 750,000 Ha of cocoa.">SAP</abbr></td><td class="text-right"><a href="#">${{turn.debt_wbsap|floatformat:0|intcomma}}</a></td><td class="text-right">{{turn.game.INT_RATE.wbsap|percent:"1,2"}}</td><td class="text-right">${{calc.debt_wbsap_int|floatformat:0|intcomma}}</td></tr>
                            <tr><td>Total</td><td class="text-right">${{calc.debt_total|floatformat:0|intcomma}}</td><td class="text-right"></td><td class="text-right">${{calc.debt_total_int|floatformat:0|intcomma}}</td></tr>
                        </table>
                    </div>
                </div>
                <div class="col-sm-12 col-md-4">
                    <h4><span class="glyphicon glyphicon-user" aria-hidden="true"></span> Happiness</h4>
                    <div class="panel panel-default">
                        <table class="table">
                            <tr><th>Category</th><th class="text-right">Rating</th></tr>
                            <tr><td>Health</td><td class="text-right">{{calc.hap_health|percent}}</td></tr>
                            <tr><td>Education</td><td class="text-right">{{calc.hap_education|percent}}</td></tr>
                            <tr><td>Security</td><td class="text-right">{{calc.hap_security|percent}}</td></tr>
                            <tr><td>Environment</td><td class="text-right">{{calc.hap_env|percent}}</td></tr>
                            <tr><td colspan="2"><strong>The Masses</strong> <small>(Lower / Middle Classes)</small></td></tr>
                            <tr><td>Food</td><td class="text-right">{{calc.hap_lfood|percent}}</td></tr>
                            <tr><td>Luxuries</td><td class="text-right">{{calc.hap_llux|percent}}</td></tr>
                            <tr><td>Taxes</td><td class="text-right">{{calc.hap_ltax|percent}}</td></tr>
                            <tr><td>Overall</td><td class="text-right">{{calc.hap_lgen|percent}}</td></tr>
                            <tr><td colspan="2"><strong>The Elite</strong> <small>(Upper Class)</small></td></tr>
                            <tr><td>Food</td><td class="text-right">{{calc.hap_ufood|percent}}</td></tr>
                            <tr><td>Luxuries</td><td class="text-right">{{calc.hap_ulux|percent}}</td></tr>
                            <tr><td>Taxes</td><td class="text-right">{{calc.hap_utax|percent}}</td></tr>
                            <tr><td>Overall</td><td class="text-right">{{calc.hap_ugen|percent}}</td></tr>
                        </table>
                    </div>
                </div>
        </div>

    {% else %}
        <div class="alert alert-warning">Unable to find an active game instance.</div>
    {% endif %}
{% endblock %}
